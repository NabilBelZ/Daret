<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Profile</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>


  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="css/all.min.css" />
  <link rel="stylesheet" href="css/framework.css" />
  <link rel="stylesheet" href="css/master.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;500&display=swap" rel="stylesheet" />

  <style>
    ::-webkit-scrollbar-thumb {
      background-color: #df4881ab;
    }
    ::-webkit-scrollbar-thumb:hover {
      background-color: #df4881ab;
    }
    .logo{
      width: 230px;
      height: 75px;
      transform: translateY(-15px);
    }
    .logo img{
      width: 80%;
      height: 100%;
    }
    .page{
      background-color: #ffc0cb2b;
    }
    .welcome, .latest-news, .quick-draft, .targets{
      box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;
    }
    .form-control{
      width: 300px;
    }
    .row{
      padding-left: 75px;
    }
    .page h1::before {
      background-color: white;

    }
    .page h1::after {
      background-color: #f5c2c7;

    }
    h1{
      font-size: 2em;
      font-weight: bold;
    }
    h2{
      font-size: 1.5em;
      color: #DF4881FF;
      font-weight: bold;
    }
  </style>
</head>
<body>
<div class="page d-flex">
  <div class="sidebar bg-white p-20 p-relative">
    <div class="logo">
      <a href=""><img src="/images/logo.png"></a>
    </div>
    <ul>
      <li th:if="${session.role eq 'admin'}">
        <a class="d-flex align-center fs-14 c-black rad-6 p-10" href="/adminDashboard">
          <i class="fa-regular fa-chart-bar fa-fw"></i>
          <span>Dashboard</span>
        </a>
      </li>
      <li th:if="${session.role eq 'user'}">
        <a class="d-flex align-center fs-14 c-black rad-6 p-10" href="/userDashboard">
          <i class="fa-regular fa-chart-bar fa-fw"></i>
          <span>Dashboard</span>
        </a>
      </li>
      <li>
        <a class="active d-flex align-center fs-14 c-black rad-6 p-10" href="/profile">
          <i class="fa-regular fa-user fa-fw"></i>
          <span>Profil</span>
        </a>
      </li>
      <li th:if="${session.role eq 'user'}">
        <a class="d-flex align-center fs-14 c-black rad-6 p-10" href="#" th:data-bs-toggle="modal" th:data-bs-target="'#wallet'">
          <i><img style="width: 19px" src="/images/wallet.png"></i>
          <span>Wallet</span>
        </a>
        <div class="modal fade" id="wallet" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" role="dialog" aria-labelledby="participationModalLabel" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title">Wallet</h5>
                <button type="button" class="btn-close tahiri"  data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body" style="text-align: center">
                Votre sole actuelle est <br>
                <div class="wallet">
                  <h4  style="color: green"><b th:text="${user.solde}"></b> Dh</h4>
                </div>
              </div>
              <div class="modal-footer">
                <a href="#" th:data-bs-toggle="modal" th:data-bs-target="'#ajoutSolde'" class="btn btn-success" onmouseover="this.style.backgroundColor='#198754';">Ajouter solde</a>
                <button type="button" class="btn btn-secondary tahiri" data-bs-dismiss="modal">Fermer</button>
              </div>
            </div>
          </div>
        </div>
        <!-- MODAL : Ajouter solde -->
        <div class="modal fade" id="ajoutSolde" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" role="dialog" aria-labelledby="participationModalLabel" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title">Wallet</h5>
                <button type="button" class="btn-close tahiri"  data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body" style="text-align: center">
                <form action="/ajouterSoldeProcess" method="post">
                  <div class="input-group">
                    <input type="text" class="form-control" name="amount">
                    <span class="input-group-text">Dh</span>
                  </div>
                  <br>
                  <input type="submit" value="Ajouter" class="btn btn-success">
                </form>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary tahiri" data-bs-dismiss="modal">Fermer</button>
              </div>
            </div>
          </div>
        </div>
      </li>
      <li th:if="${session.role eq 'admin'}">
        <a class="d-flex align-center fs-14 c-black rad-6 p-10" href="/ajouterDaret">
          <i class="fa-solid fa-plus"></i>
          <span>Créer une daret</span>
        </a>
      </li>
      <li th:if="${session.role eq 'admin'}">
        <a class="d-flex align-center fs-14 c-black rad-6 p-10" href="/tontines">
          <i class="fa-solid fa-diagram-project fa-fw"></i>
          <span>Liste des darets</span>
        </a>
      </li>

      <li th:if="${session.role eq 'user'}">

        <a class=" d-flex align-center fs-14 c-black rad-6 p-10" href="/mesParticipations">
          <i><img style="width: 19px" src="/images/10559921_contribution_donation_charity_grant_financial_icon.png"></i>
          <span>Mes participations</span>
        </a>
      </li>
      <li th:if="${session.role eq 'admin'}">
        <a class="d-flex align-center fs-14 c-black rad-6 p-10" href="/listDemandesParticipation">
          <i><img style="width: 21px" src="/images/9023673_git_pull_request_fill_icon.png"></i>
          <span>Liste des demandes</span>
        </a>
      </li>
      <li th:if="${session.role eq 'admin'}">
        <a class="d-flex align-center fs-14 c-black rad-6 p-10" href="/listUsers">
          <i class="fa-regular fa-circle-user fa-fw"></i>
          <span>Liste des utilisateurs</span>
        </a>
      </li>
      <!-- <li>
        <a class="d-flex align-center fs-14 c-black rad-6 p-10" href="settings.html">
          <i class="fa-solid fa-gear fa-fw"></i>
          <span>Settings</span>
        </a>
      </li> -->
      <li th:if="${session.role eq 'user'}">
        <a class="d-flex align-center fs-14 c-black rad-6 p-10" href="/listeTontines">
          <i class="fa-solid fa-diagram-project fa-fw"></i>
          <span>Darets</span>
        </a>
      </li>
      <li>
        <a class="d-flex align-center fs-14 c-black rad-6 p-10" href="/seDeconnecter">
          <i class="fa-solid fa-arrow-right-from-bracket"></i>
          <span>Se déconnecter</span>
        </a>
      </li>
    </ul>
  </div>
  <div class="content w-full">
    <!-- Start Head -->
    <div class="head bg-white p-15 between-flex">
      <div class="search p-relative">
        <input class="p-10" type="search" placeholder="Type A Keyword"/>
      </div>
      <div class="icons d-flex align-center">
        <img src="imgs/avatar.png"/>
      </div>
    </div>
    <!-- End Head -->
    <h1 class="p-relative" style="color: #DF4881FF";>Profil</h1>
    <div class="profile-page m-20">
      <!-- Start Overview -->
      <div class="overview bg-white rad-10 d-flex align-center">
        <div class="avatar-box txt-c p-20">
          <img class="rad-half mb-10" src="imgs/avatar.png" alt="" />
          <h3 class="m-0" th:text="${user.lastname} + ' ' + ${user.firstname}"></h3>
          <p class="c-grey mt-10">Level 20</p>
          <div class="level rad-6 bg-eee p-relative">
            <span style="width: 100%;"></span>
          </div>
          <p class="c-grey m-0 fs-13" style="padding-top: 10px;">550 Rating</p>
        </div>
        <div class="info-box w-full txt-c-mobile">
          <!-- Start Information Row -->
          <div class="box p-20 d-flex align-center">
            <h4 class="c-grey fs-15 m-0 w-full">General Information</h4>
            <div class="fs-14">
              <span class="c-grey">Nom:</span>
              <span th:text="${user.lastname}"></span>
            </div>
            <div class="fs-14">
              <span class="c-grey">Prénom:</span>
              <span th:text="${user.firstname}"></span>
            </div>
            <div class="fs-14">
              <span class="c-grey">E-mail:</span>
              <span th:text="${user.email}"></span>
            </div>
            <div class="fs-14">
              <script>
                function toggle(){
                  var checkinput = document.querySelector('#checkinput');
                  if(checkinput.checked){
                    checkinput.checked=false;
                  }
                }
              </script>
              <label>

                <input class="toggle-checkbox" type="checkbox" id="checkinput"  data-bs-toggle="modal" data-bs-target="#modal_general_info"/>
                <div class="toggle-switch"></div>

                <div class="modal fade" id="modal_general_info" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                  <div class="modal-dialog">
                    <div class="modal-content">
                      <div class="modal-header">
                        <h5 class="modal-title">Edit general informations</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" onclick="toggle()"></button>
                      </div>
                      <div class="modal-body">
                        <form th:action="@{/modifierInfoUser_process}" method="post" th:object="${user}">
                          <div class="row">
                            <label class="form-label">Nom :</label>
                            <input class="form-control" type="text" th:field="*{firstname}">
                          </div>
                          <div class="row">
                            <label class="form-label">Prénom :</label>
                            <input  class="form-control" type="text" th:field="*{lastname}">
                          </div>
                          <div class="row">
                            <label class="form-label">E-mail :</label>
                            <input  class="form-control" type="text" th:field="*{email}">
                          </div>
                          <input type="submit" value="Enregistrer" class="btn btn-primary" style="margin-left: 150px; margin-top: 20px;">
                        </form>
                      </div>
                      <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" onclick="toggle()" >Close</button>
                      </div>
                    </div>
                  </div>
                </div>
              </label>
            </div>
          </div>
          <!-- End Information Row -->
          <!-- Start Information Row -->
          <div class="box p-20 d-flex align-center">
            <h4 class="c-grey w-full fs-15 m-0">Personal Information</h4>
            <div class="fs-14">
              <span class="c-grey">Date de naissance:</span>
              <span>25/10/1982</span>
            </div>
            <div class="fs-14">
              <span class="c-grey">Numéro:</span>
              <span>(+212) 6 64 73 65 15</span>
            </div>
            <div class="fs-14">
              <span class="c-grey">Mot de passe:</span>
              <span>*********</span>
            </div>
            <div class="fs-14">
              <script>
                function toggle_pers_info(){
                  var checkinput = document.querySelector('#check_perso_info');
                  if(checkinput.checked){
                    checkinput.checked=false;
                  }
                }
              </script>
              <label>
                <input class="toggle-checkbox" type="checkbox" id="check_perso_info"  data-bs-toggle="modal" data-bs-target="#Personal_Information"/>
                <div class="toggle-switch"></div>

                <div class="modal fade" id="Personal_Information" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                  <div class="modal-dialog">
                    <div class="modal-content">
                      <div class="modal-header">
                        <h5 class="modal-title">Edit Personal Information</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" onclick="toggle_pers_info()"></button>
                      </div>
                      <div class="modal-body">
                        <form th:action="@{/modifierMotdePasse_process}" method="post" th:object="${user}">
                          <script th:if="${password_error}">
                            alert('Mot de passe incorrect');
                            window.location.href="/profile";
                          </script>
                          <div class="row">
                            <label class="form-label">Ancien mot de passe :</label>
                            <input class="form-control" type="text" name="oldPassword">
                          </div>
                          <div class="row">
                            <label class="form-label">Nouveau mot de passe :</label>
                            <input class="form-control" type="text" name="newPassword">
                          </div>
                          <input type="submit" value="Enregistrer" class="btn btn-primary" style="margin-left: 150px; margin-top: 20px;">
                        </form>
                        <!-- <div class="row">
                          <label class="form-label">Date de naissance :</label>
                          <input class="form-control" type="text">
                        </div>
                        <div class="row">
                          <label class="form-label">Numéro Tel :</label>
                          <input  class="form-control" type="text">
                        </div>
                        <div class="row">
                          <label class="form-label">Pays :</label>
                          <input  class="form-control" type="text">
                        </div>
                        <input type="submit" value="Enrengistrer" class="btn btn-primary" style="margin-left: 150px; margin-top: 20px;">
                      -->
                      </div>
                      <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" onclick="toggle_pers_info()" >Close</button>
                      </div>
                    </div>
                  </div>
                </div>
              </label>
            </div>
          </div>
          <!-- End Information Row -->
          <!-- Start Information Row -->
          <div class="box p-20 d-flex align-center">
            <h4 class="c-grey w-full fs-15 m-0">Billing Information</h4>
            <div class="fs-14">
              <span class="c-grey">Payment Method:</span>
              <span>Paypal</span>
            </div>
            <div class="fs-14">
              <span class="c-grey">Email:</span>
              <span>email@website.com</span>
            </div>
            <div class="fs-14">
              <span class="c-grey">Subscription:</span>
              <span>Monthly</span>
            </div>
            <div class="fs-14">
              <script>
                function toggle_billing(){
                  var checkinput = document.querySelector('#billing');
                  if(checkinput.checked){
                    checkinput.checked=false;
                  }
                }
              </script>
              <label>

                <input class="toggle-checkbox" type="checkbox" id="billing"  data-bs-toggle="modal" data-bs-target="#Billing_Information"/>
                <div class="toggle-switch"></div>

                <div class="modal fade" id="Billing_Information" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                  <div class="modal-dialog">
                    <div class="modal-content">
                      <div class="modal-header">
                        <h5 class="modal-title">Edit general informations</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" onclick="toggle_billing()"></button>
                      </div>
                      <div class="modal-body">
                        Les données sont statiques.
                        <!-- <div class="row">
                         <label class="form-label">Payment Method :</label>
                         <input class="form-control" type="text">
                       </div>
                       <div class="row">
                         <label class="form-label">E-mail :</label>
                         <input  class="form-control" type="text">
                       </div>
                       <div class="row">
                         <label class="form-label">Subscription :</label>
                         <input  class="form-control" type="text">
                       </div>
                       <input type="submit" value="Enrengistrer" class="btn btn-primary" style="margin-left: 150px; margin-top: 20px;">
                     -->
                      </div>
                      <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" onclick="toggle_billing()" >Close</button>
                      </div>
                    </div>
                  </div>
                </div>

              </label>
            </div>
          </div>
          <!-- End Information Row -->
        </div>
      </div>
      <!-- End Overview -->
      <!-- Start Other Data -->
      <div th:if="${session.role eq 'user'}"  class="activities p-20 bg-white rad-10 mt-20">
        <h2 class="mt-0 mb-10">Mes dernières participations</h2>
        <p class="mt-0 mb-20 c-black fs-15">Dernière participation de l'utilisateur</p>
        <div th:each="participation : ${mesParticipations}"class="activity d-flex align-center txt-c-mobile">
          <svg viewBox="0 0 24 24" height="80px" width="80px" xmlns="http://www.w3.org/2000/svg"><g data-name="Piggy Bank"><path d="M13.12 6.93h-2.6a.38.38 0 0 1-.36-.26C9.65 5.09 7.77 4.28 7 4a.23.23 0 0 0-.31.22v2.5a.45.45 0 0 1-.31.42 4.27 4.27 0 0 0-2.93 3.34.41.41 0 0 1-.41.35h-.56a.49.49 0 0 0-.34.14.48.48 0 0 0-.14.34v2a.52.52 0 0 0 .14.35.49.49 0 0 0 .34.14h.62a.43.43 0 0 1 .42.33A4.28 4.28 0 0 0 7 17.44a.27.27 0 0 1 .23.26V19a1 1 0 0 0 1.92 0v-1.22a.27.27 0 0 1 .26-.27h6.52a.32.32 0 0 1 .23.09.34.34 0 0 1 .1.23V19a1 1 0 0 0 1.92 0v-1.65a.61.61 0 0 1 .29-.52 4.23 4.23 0 0 0 2-3.58Z" fill="#df4881" class="fill-f94060"></path><path d="M17.12 4.84a4.88 4.88 0 1 1-4.87 4.87 4.87 4.87 0 0 1 4.87-4.87" fill="#dbd8d0" class="fill-ffeabb"></path><path d="M9.37 17.51a.28.28 0 0 0-.24.27V19a1 1 0 0 1-1 1 1 1 0 0 1-.46-.11 1 1 0 0 0 .49-.89v-1.22a.27.27 0 0 1 .27-.27Z" fill="#f598b1" class="fill-d62657"></path><path d="M20.47 13.26a4.66 4.66 0 0 1-1 .75 4.23 4.23 0 0 1-1.91 2.81.64.64 0 0 0-.31.56v1.66a1 1 0 0 1-.48.81.94.94 0 0 0 .49.15 1 1 0 0 0 1-1v-1.65a.61.61 0 0 1 .29-.52 4.22 4.22 0 0 0 1.92-3.57ZM15.27 17.51Z" fill-rule="evenodd" fill="#f598b1" class="fill-d62657"></path><path d="M6.72 4.21A.22.22 0 0 1 6.81 4 .26.26 0 0 1 7 4c.75.27 2.63 1.08 3.14 2.66a.38.38 0 0 0 .32.26h-.87a.42.42 0 0 1-.4-.3 4.5 4.5 0 0 0-2.48-2.34s.03-.05.01-.07Z" fill="#f598b1" class="fill-d62657"></path><path d="M17.08 4.84a4.62 4.62 0 0 0-1.64.3h.2a4.58 4.58 0 0 1 0 9.16h-.2a4.88 4.88 0 1 0 1.68-9.45" fill="#8c8a88" class="fill-f7bf75"></path><path d="M16.63 7.46v-.2a.5.5 0 0 1 .5-.5.5.5 0 0 1 .5.5v.2a1.38 1.38 0 0 1 .5.32 1.51 1.51 0 0 1 .29.45.5.5 0 0 1-.26.65.51.51 0 0 1-.66-.26.41.41 0 0 0-.08-.13.45.45 0 0 0-.29-.12.4.4 0 1 0 0 .8 1.4 1.4 0 0 1 .5 2.71v.21a.5.5 0 0 1-.5.5.5.5 0 0 1-.5-.5v-.21a1.42 1.42 0 0 1-.48-.31 1.39 1.39 0 0 1-.31-.45.52.52 0 0 1 .27-.66.51.51 0 0 1 .65.27.38.38 0 0 0 .09.13.39.39 0 0 0 .27.11.39.39 0 0 0 .39-.4.4.4 0 0 0-.4-.4 1.4 1.4 0 0 1-.5-2.71Z" fill="#df4881" fill-rule="evenodd" class="fill-f1734d"></path><path d="M5.86 9.38V10a.5.5 0 0 0 .5.5.5.5 0 0 0 .5-.5v-.62a.5.5 0 0 0-.5-.5.5.5 0 0 0-.5.5Z" fill-rule="evenodd" fill="#f598b1" class="fill-d62657"></path></g></svg>
          <div style="margin: 0 0 0 20px" class="info">
            <b><h5 class="d-block mb-10" th:text="${participation.nomDaret}"></h5></b>
            <h6 style="margin-bottom: 10px" class="d-block c-grey " th:text="${participation.descriptionDaret}"></h6>
            <div class="d-block c-green">
              <i class="fa-solid fa-dollar-sign"></i>
              <!-- Add participation montant here -->
              <span  th:text="${participation.montantParticipation}"></span>
            </div>
          </div>
          <div class="date">
            <div class="d-flex">
              Date de démarrage &nbsp;: &nbsp;<span class="d-block mb-10 c-grey" th:text="${#dates.format(participation.dateDemarrage, 'dd/MM/yyyy')}"></span>
            </div>
            Date de fin &nbsp;: &nbsp;<span class="c-grey" th:text="${#dates.format(participation.dateFin, 'dd/MM/yyyy')}"></span>
          </div>
        </div>



      </div>
    </div>
    <!-- End Other Data -->
  </div>
</div>
</div>
</body>
</html>
